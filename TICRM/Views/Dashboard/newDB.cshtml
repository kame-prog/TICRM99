@model TICRM.DTOs.AccountViewModel
@{
    ViewBag.Title = "New Dashboard";
}

@*Device Info Box*@
<style>

    /*CardView*/
    .container {
        width: 385px;
        height: 226px;
        margin: 50px auto;
    }

    .card {
        float: left;
        width: 180px;
        height: 100%;
        border: 1px solid;
        border-radius: 5px;
        margin-right: 10px;
        background: #F9F9F9;
        position: relative;
        box-shadow: 0px 0px 3px #ddd;
    }

        .card .inner {
            background: #F9F9F9;
            border: 1px solid #E3E3E3;
            border-radius: 0px 0px 5px 5px;
            width: 100%;
            height: 100px;
            position: absolute;
            bottom: -1px;
            left: -1px;
            font-family: arial;
            text-align: center;
            box-shadow: inset 0px 0px 1px #FFF;
        }

            .card .inner .title {
                display: block;
                font-size: 16px;
                color: #fff;
                margin-top: -15px;
            }

                .card .inner .title .text {
                    display: inline-block;
                    padding: 5px 15px;
                    border-radius: 50px;
                    font-weight: bold;
                }

            .card .inner .number {
                color: #313A3E;
                font-size: 50px;
                font-weight: bold;
                display: block;
                margin-top: 5px;
            }

            .card .inner .measure {
                color: #676767;
                font-size: 10px;
                display: block;
                margin-top: -10px;
            }

    .temp {
        background: #EC6F69;
        border: 1px solid #DE3932;
    }

        .temp .inner {
            border-top: 1px solid #DE3932;
        }

            .temp .inner .text {
                border: 1px solid #DE3932;
                background: #EC6F69;
                text-shadow: 1px 1px 0px #DE3932;
            }

            .temp .inner .icon {
                display: block;
                position: absolute;
                top: -65px;
                left: 75px;
                width: 17px;
                height: 17px;
                background: #fff;
                border-radius: 17px;
                border: 4px solid #EC6F69;
                box-shadow: 0 0 0 4px #fff, 1px 1px 0 4px #DE3932;
            }

                .temp .inner .icon:before {
                    content: '';
                    display: block;
                    width: 7px;
                    height: 25px;
                    background: #fff;
                    position: absolute;
                    top: -30px;
                    left: 0px;
                    border: 5px solid #EC6F69;
                    border-radius: 10px 10px 0px 0px;
                    border-bottom: 0px none;
                    box-shadow: 0 -4px 0 4px #fff, 4px -3px 0 1px #DE3932;
                }

            .temp .inner .icons {
                display: block;
                position: absolute;
                top: -85px;
                left: 70px;
                width: 40px;
                height: 40px;
            }

                .temp .inner .icons:before {
                    content: '';
                    display: block;
                    width: 7px;
                    height: 25px;
                    position: absolute;
                    top: -30px;
                    left: 0px;
                }

    .Dinfo-box {
        display: block;
        min-height: 90px;
        background: #fff;
        width: 100%;
        margin-bottom: 15px;
    }

    .Dinfo-box-icon {
        border-top-left-radius: 2px;
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
        border-bottom-left-radius: 2px;
        display: block;
        float: left;
        height: 150px;
        width: 150px;
        text-align: center;
        font-size: 45px;
        line-height: 90px;
        background-color: #7fceff;
        margin-left: 7%;
    }

    .Dinfo-box-content {
        padding: 5px 10px;
        margin-left: 90px;
    }

    .active, .collapsible:hover {
        background-color: transparent !important;
    }
</style>

@*Counters*@
<style>
    .counters {
        padding: 20px 0;
        border-radius: 5px;
    }

    .count-titles {
        font-size: 40px;
        font-weight: normal;
        margin-top: 10px;
        margin-bottom: 0;
        text-align: center;
    }

    .count-texts {
        font-size: 13px;
        font-weight: normal;
        margin-top: 10px;
        margin-bottom: 0;
        text-align: center;
    }

    .fa-2x {
        margin: 0 auto;
        float: none;
        display: table;
        color: #7FCEFF;
    }
</style>

@*Counters*@
<style>
    .counter {
        padding: 20px 0;
        border-radius: 5px;
    }

    .count-title {
        font-size: 80px;
        font-weight: normal;
        margin-top: 10px;
        margin-bottom: 0;
        text-align: center;
    }

    .count-text {
        font-size: 20px;
        font-weight: normal;
        margin-top: 10px;
        margin-bottom: 0;
        text-align: center;
    }

    .fa-3x {
        margin: 0 auto;
        float: none;
        display: table;
        color: #7FCEFF;
    }
</style>
<!-- BEGIN: Subheader -->
<div class="m-subheader ">
    <div class="d-flex align-items-center">
        <div class="mr-auto">
            <h3 class="m-subheader__title m-subheader__title--separator">Dashboard</h3>
            <ul class="m-subheader__breadcrumbs m-nav m-nav--inline">
                <li class="m-nav__item m-nav__item--home">
                    <a href="#" class="m-nav__link m-nav__link--icon">
                        <i class="m-nav__link-icon la la-home"></i>
                    </a>
                </li>
                <li class="m-nav__separator">-</li>
                <li class="m-nav__item">
                    <a href="#" class="m-nav__link">
                        <span class="m-nav__link-text">Dashboard</span>
                    </a>
                </li>
                <li class="m-nav__separator">-</li>
                <li class="m-nav__item">
                    <a href="#" class="m-nav__link">
                        <span class="m-nav__link-text">Reports</span>
                    </a>
                </li>
            </ul>
        </div>
        <div>
            <span class="m-subheader__daterange" id="m_dashboard_daterangepicker">
                <span class="m-subheader__daterange-label">
                    <span class="m-subheader__daterange-title"></span>
                    <span class="m-subheader__daterange-date m--font-brand"></span>
                </span>
                <a href="#" class="btn btn-sm btn-brand m-btn m-btn--icon m-btn--icon-only m-btn--custom m-btn--pill">
                    <i class="la la-angle-down"></i>
                </a>
            </span>
        </div>
    </div>
</div>



<div class="m-content">

    <div id="defaultDashboard">

        <!--Devices MAP and Tech support-->
        <div class="row">
            <div class="col-md-7 col-sm-12">
                <div class="m-portlet m-portlet--tab bg-dashboard-box">
                    <div class="m-portlet__head">
                        <div class="m-portlet__head-caption">
                            <div class="m-portlet__head-title">
                                <span class="m-portlet__head-icon m--hide">
                                    <i class="la la-gear"></i>
                                </span>
                                <h3 class="m-portlet__head-text">
                                    Devices
                                </h3>
                            </div>
                        </div>
                        <select class="form-control m-input" id="accountmap" style="margin-right:auto;"></select>
                    </div>
                    <div class="m-portlet__body">
                        <div id="DevicesMap" style="height: 350px; width: 100%;"></div>
                    </div>
                </div>
            </div>

            <div class="col-md-5 col-sm-12">
                <div class="row">
                    <div class="col-12">
                        <div class="m-portlet m-portlet--tab bg-dashboard-box">
                            <div class="m-portlet__head">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h3 class="m-portlet__head-text">
                                            Costs
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div id="CostsChart" style="height: 100px; width: 100%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <div class="m-portlet m-portlet--tab bg-dashboard-box">
                            <div class="m-portlet__head" style="height: 40px;">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h3 class="m-portlet__head-text">
                                            Sales
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div id="salesChart" style="height: 125px; width: 100%;"></div>
                            </div>
                        </div>

                    </div>
                    <div class="col-6">
                        <div class="m-portlet m-portlet--tab bg-dashboard-box">
                            <div class="m-portlet__head" style="height: 40px;">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h4 class="m-portlet__head-text">
                                            Tech Support
                                        </h4>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div id="TechSupportInsightss" class="text-center" style=" height: 125px; width: 100%;">
                                    <div id="workorder">
                                        <p class="text-danger text-center">
                                            <i class="fa fa-chevron-down"></i>18%
                                        </p>
                                        <p class="workorder-counter" id="workordercounts"></p>
                                        <h4>WorkOrders</h4>
                                    </div>

                                    <div id="workorder">
                                        <p class="text-danger text-center">
                                            <i class="fa fa-chevron-down"></i>18%
                                        </p>
                                        <p class="workorder-counter" id="alertcounts"></p>
                                        <h4>Alerts</h4>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

  

    </div>

    <div id="salesDashboard">
        <!--Opportunities MAP and Sales-->

        <div class="row">
            <div class="col-md-6 col-sm-12">
                <div class="m-portlet m-portlet--tab bg-dashboard-box">
                    <div class="m-portlet__head" style="height:40px">
                        <div class="m-portlet__head-caption">
                            <div class="m-portlet__head-title">
                                <span class="m-portlet__head-icon m--hide">
                                    <i class="la la-gear"></i>
                                </span>
                                <h3 class="m-portlet__head-text">
                                    Opportunities
                                </h3>
                            </div>
                        </div>
                    </div>
                    <div class="m-portlet__body">
                        <div id="OpportunitiesMap" style="height: 400px; width: 100%;"></div>
                    </div>
                </div>
            </div>

            <div class="col-md-6 col-sm-12">
                <div class="row">
                    <div class="col-md-12">
                        <div class="m-portlet m-portlet--tab bg-dashboard-box">
                            <div class="m-portlet__head" style="height:40px">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h3 class="m-portlet__head-text">
                                            Accounts
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div id="AccountsMap" style="height: 400px; width: 100%;"></div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>


        <div class="row">
            <div class="col-md-3">
                <div class="m-portlet m-portlet--tab bg-dashboard-box">
                    <div class="m-portlet__head" style="height:40px">
                        <div class="m-portlet__head-caption">
                            <div class="m-portlet__head-title">
                                <span class="m-portlet__head-icon m--hide">
                                    <i class="la la-gear"></i>
                                </span>
                                <h3 class="m-portlet__head-text">
                                    Sales
                                </h3>
                            </div>
                        </div>
                    </div>
                    <div class="m-portlet__body">
                        <div id="salesChart2" style="height: 150px; width: 100%;"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">

                <div class="m-portlet m-portlet--tab bg-dashboard-box">
                    <div class="m-portlet__head" style="height:40px">
                        <div class="m-portlet__head-caption">
                            <div class="m-portlet__head-title">
                                <span class="m-portlet__head-icon m--hide">
                                    <i class="la la-gear"></i>
                                </span>
                                <h3 class="m-portlet__head-text">
                                    Assets
                                </h3>
                            </div>
                        </div>
                    </div>
                    <div class="m-portlet__body">
                        <div id="Assetschart" style="height: 150px; width: 100%;"></div>
                    </div>
                </div>
            </div>
        </div>
        <!--Accounts MAP and Assets chart-->


    </div>

    <div id="techDashboard">

        <div class="row">
            <div class="col-md-9">
                <!--Disconnection Line and Accounts tree-->
                <div class="row bg-dashboard-box" style="height:400px;">
                    <div class="col-md-8 col-sm-12">
                        <div class="m-portlet m-portlet--tab bg-dashboard-box">
                            <div class="m-portlet__head">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h3 class="m-portlet__head-text">
                                            Disconnections
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div id="Disconnectionchart" style="height: 120px; width: 100%;">

                                </div>
                            </div>
                        </div>

                    </div>

                    <div class="col-md-4 col-sm-12">
                        <div class="m-portlet m-portlet--tab bg-dashboard-box">
                            <div class="m-portlet__head">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h3 class="m-portlet__head-text">
                                            Accounts | Devices
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div id="jstree1" style="height: 120px; overflow-y: scroll;">
                                    <!-- in this example the tree is populated from inline HTML -->

                                    <ul>
                                        @foreach (var item in Model.DashboardAccounts)
                                        {
                                            <li data-jstree="type:file">
                                                <span class="fa fa-map-marker" style="color:#7FCEFF"></span>
                                                @item.Name


                                                <ul>
                                                    @foreach (var Assetitem in Model.DashboardDevices.Where(x => x.AccountId == item.AccountId))
                                                    {
                                                        <li macaddress="" deviceId="" data-jstree='{ "icon" : "fa fa-warning m--font-danger" }'>
                                                            <span class="fa fa-users" style="color:#7FCEFF"></span>
                                                            @Assetitem.Name

                                                        </li>
                                                    }
                                                </ul>
                                            </li>

                                        }
                                    </ul>


                                </div>
                            </div>
                        </div>

                    </div>

                </div>

                <!--Power consumption Line and Accounts tree-->
                <div class="row bg-dashboard-box" style="margin-top:2.5%; height:400px;">

                    <div class="col-md-8 col-sm-12">
                        <div class="m-portlet m-portlet--tab bg-dashboard-box">
                            <div class="m-portlet__head">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h3 class="m-portlet__head-text">
                                            Power Consuption
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div id="powerconsumptionchart" style="height: 120px; width: 100%;"></div>
                            </div>
                        </div>

                    </div>

                    <div class="col-md-4 col-sm-12">
                        <div class="m-portlet m-portlet--tab bg-dashboard-box">
                            <div class="m-portlet__head">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h3 class="m-portlet__head-text">
                                            Account Devices
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div id="consumptionTree" style="height: 120px; overflow-y: scroll;">
                                    <!-- in this example the tree is populated from inline HTML -->

                                    <ul>
                                        @foreach (var item in Model.ConsumptionAccounts)
                                        {
                                            <li data-jstree="type:file">
                                                <span class="fa fa-map-marker" style="color:#7FCEFF"></span>
                                                @item.Name

                                                <ul>
                                                    @foreach (var Assetitem in Model.ConsumptionDevices.Where(x => x.AccountId == item.AccountId))
                                                    {
                                                        <li macaddress="" deviceId="" data-jstree='{ "icon" : "fa fa-warning m--font-danger" }'>
                                                            <span class="fa fa-users" style="color:#7FCEFF"></span>
                                                            @Assetitem.Name

                                                        </li>
                                                    }
                                                </ul>
                                            </li>

                                        }
                                    </ul>


                                </div>
                            </div>
                        </div>

                    </div>

                </div>
            </div>

            <div class="col-md-3">
                <!--Channels and Gateway chart-->
                <div class="row">

                    <div class="col-md-12 col-sm-12" style="height:300px">
                        <div class="m-portlet m-portlet--tab bg-dashboard-box">
                            <div class="m-portlet__head">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h3 class="m-portlet__head-text">
                                            Channels
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div id="channelschart" style="height: 150px; width: 100%;"></div>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12 col-sm-12" style="margin-top:-20px">
                        <div class="m-portlet m-portlet--tab bg-dashboard-box" style="height:285px;">
                            <div class="m-portlet__head">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h3 class="m-portlet__head-text">
                                            Gateways
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div id="gatewayChart" style="height: 150px; width: 100%;"></div>
                            </div>
                        </div>

                    </div>

                </div>

                <div class="row">
                    <div class="col-md-12 col-sm-12">
                        <div class="m-portlet m-portlet--tab bg-dashboard-box" style="margin-top:-20px; height:250px;">
                            <div class="m-portlet__head">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h3 class="m-portlet__head-text">
                                            Gateway Devices
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div class="counter" style="height: 180px; width: 100%;">
                                    <i class="fa fa-microchip fa-3x"></i>
                                    <h2 id="" class="timer count-title count-number" data-to="@ViewBag.Gateways" data-speed="1500">@ViewBag.Gateways</h2>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>

            </div>
        </div>



    </div>

</div>

<!-- Start:Map Right Slider Modal -->
<div class="modal fade modal-MapRightSlider-fade" id="MapRightSliderModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2" aria-hidden="true">
    <div class="modal-dialog modal-MapRightSlider-dialog modal-MapRightSlider-slideout" role="document">
        <div class="modal-content modal-content-MapRightSlider">
            <div class="modal-header modal-header-MapRightSlider">

                <h5 id="Dname" class=" modal-header-title" style="font-size:30px;padding-top:5px;">&nbsp;&nbsp;</h5>

                <button type="button" class="close modalMapRightSliderClose" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>


            </div>
            <div class="modal-body modal-body-MapRightSlider">
                <div id="btnsCloud" class="m-portlet m-portlet--mobile  m-portlet--rounded">
                    <div class="m-portlet__body">
                        <div class="row col-sm-12" id="toggle_event_editing">
                            <div class=" col-sm-4">
                                <div>
                                    <a onclick="ToConfirms()" class="btn btn-success ">
                                        <span style="color:white">
                                            <i class="la la-plus"></i>
                                            <span>Update FW</span>
                                        </span>
                                    </a>
                                </div>
                            </div>
                            <div class=" col-sm-4">
                                <div>
                                    <a onclick="nevToURL()" class="btn btn-success">
                                        <span style="color:white">
                                            <i class="la la-cloud"></i>
                                            <span>Go To IBM</span>
                                        </span>
                                    </a>
                                </div>
                            </div>
                            <div class=" col-sm-4">
                                <div>
                                    <a href="#workflow" class="btn btn-success" data-toggle="collapse" >
                                        <span style="color:white">
                                            <i class="la la-edit"></i>
                                            <span>Create Workflow</span>
                                        </span>
                                    </a>
                                </div>
                            </div>


                        </div>
                    </div>
                </div>

                <div id="btnsAmazon" class="m-portlet m-portlet--mobile  m-portlet--rounded">
                    <div class="m-portlet__body">
                        <div class="row col-sm-12" id="toggle_event_editing">
                            <div class=" col-sm-4">
                                <div>
                                    <a onclick="ToConfirms()" class="btn btn-success">
                                        <span style="color:white">
                                            <i class="la la-plus"></i>
                                            <span>Update FW</span>
                                        </span>
                                    </a>
                                </div>
                            </div>
                            <div class=" col-sm-4">
                                <div>
                                    <a class="btn btn-success">
                                        <span style="color:white">
                                            <i class="la la-cloud"></i>
                                            <span>Go To AWS</span>
                                        </span>
                                    </a>
                                </div>
                            </div>
                            <div class=" col-sm-4">
                                <div>
                                    <a href="#workflow" class="btn btn-success" data-toggle="collapse">
                                        <span style="color:white">
                                            <i class="la la-edit"></i>
                                            <span>Create Workflow</span>
                                        </span>
                                    </a>
                                </div>
                            </div>


                        </div>
                    </div>
                </div>


                <div id="btnsINCA" class="m-portlet m-portlet--mobile  m-portlet--rounded">
                    <div class="m-portlet__body">
                        <div class="row col-sm-12" id="toggle_event_editing">
                            <div class=" col-sm-4">
                                <div>
                                    <a href="#config" class="btn btn-success" data-toggle="collapse">
                                        <span style="color:white">
                                            <i class="la la-edit"></i>
                                            <span>Configure</span>
                                        </span>
                                    </a>
                                </div>
                            </div>
                            <div class=" col-sm-4">
                                <div>
                                    <a href="#firmware" class="btn btn-success" data-toggle="collapse">
                                        <span style="color:white">
                                            <i class="la la-plus"></i>
                                            <span>Update FW</span>
                                        </span>
                                    </a>
                                </div>
                            </div>

                            <div class=" col-sm-4">
                                <div>
                                    <a href="#workflow" class="btn btn-success" data-toggle="collapse">
                                        <span style="color:white">
                                            <i class="la la-edit"></i>
                                            <span>Create Workflow</span>
                                        </span>
                                    </a>

                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <div id="workflow" class="m-form m-form--fit m-form--label-align-right m-form--group-seperator-dashed collapse">
                    <div class="row">
                        <span class="nav-item">
                            <i href="#workflow" class="fa fa-2x fa-arrow-circle-left collapsible" data-toggle="collapse" style="margin-left: 22px; margin-top: 21px; margin-bottom: -10px; color:#525151;"></i>

                        </span>
                        <h3 style="margin-left: 11px; margin-top: 20px; margin-bottom: -10px;">Device Workflow</h3>

                    </div>

                    <div class="form-group m-form__group row">
                        <div class="col-lg-6">
                            <label class="control-label">Name</label><br />
                            <div class="input-group">

                                <input class="form-control m-input" id="Wname" name="Wname">
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <label class="control-label">Sensor</label><br />
                            <select class="form-control m-input" id="Wsensors">
                                
                            </select>

                        </div>
                    </div>

                    <div class="form-group m-form__group row">
                        <div class="col-lg-6">
                            <label class="control-label">Threshold</label><br />
                            <div class="row">
                                <div class="input-group col-6">

                                    <input class="form-control m-input" id="WThreshold" name="WThreshold" placeholder="<=">
                                </div>
                                <div class="input-group col-6">

                                    <input class="form-control m-input" id="WThreshold1" name="WThreshold1" placeholder=">=">
                                </div>
                            </div>

                        </div>
                        <div class="col-lg-6">

                            <label class="control-label" for="Wpriority">
                                Priority
                            </label>
                            <select class="form-control m-input" id="Wpriority">
                                <option>
                                    High
                                </option>
                                <option>
                                    Medium
                                </option>
                                <option>
                                    Low
                                </option>

                            </select>
                        </div>
                    </div>

                    <div class="form-group m-form__group row">
                        <div class="col-lg-6">
                            <label class="control-label" for="Waction">
                                Action
                            </label>
                            <select class="form-control m-input" id="Waction">
                                <option>
                                    Email
                                </option>
                                <option>
                                    Alert
                                </option>
                                <option>
                                    Note
                                </option>
                                <option>
                                    Sugar CRM
                                </option>
                                <option>
                                    Dynamics 365
                                </option>

                            </select>
                        </div>
                        <div class="col-lg-6">
                            <label class="control-label">Description</label><br />
                            <div class="input-group">
                                <input class="form-control m-input" id="Wdescription" name="Wdescription">
                            </div>
                        </div>
                    </div>

                    <div class="form-group m-form__group row">
                        <div class="col-lg-6">
                            <label class="control-label"></label><br />

                            <label class="m-checkbox m-checkbox--state-success">
                                <input id="checkbox" onclick="checkbox()" type="checkbox">
                                Enable Cloud CRMs
                                <span></span>
                            </label>
                        </div>
                        <div id="crm" style="display:none" class="col-lg-6">
                            <label class="control-label" for="WCloud">
                                Select CRM
                            </label>
                            <select class="form-control m-input" id="WCloud">
                                <option>
                                    SUGAR CRM
                                </option>
                                <option>
                                    DYNAMICS CRM
                                </option>
                                <option>
                                    SUITE CRM
                                </option>
                                <option>
                                    ZOHO CRM
                                </option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group m-form__group row">
                        <div class="col-lg-6">
                            <button type="button" onclick="PostData()" class="btn btn-success "><i class="la la-save"></i> Submit</button>
                            <button type="reset" href="#workflow" data-toggle="collapse" class="btn btn-secondary collapsible"><i class="la la-refresh "></i> Cancel</button>
                        </div>
                    </div>

                </div>

                <div id="firmware" class="m-form m-form--fit m-form--label-align-right m-form--group-seperator-dashed collapse">
                    <div class="row">
                        <span class="nav-item">
                            <i href="#firmware" class="fa fa-2x fa-arrow-circle-left collapsible" data-toggle="collapse" style="margin-left: 22px; margin-top: 21px; margin-bottom: -10px; color:#525151;"></i>

                        </span>
                        <h3 style="margin-left: 11px; margin-top: 20px; margin-bottom: -10px;">Update Firmware</h3>

                    </div>

                    <div class="form-group m-form__group row">
                        <div class="col-lg-6">
                            <label class="control-label">Firmware Version</label><br />
                            <div class="input-group">

                                <input class="form-control m-input" id="FWver" name="FWver">
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <label class="control-label">Description</label><br />
                            <input class="form-control m-input" id="FWdes">

                        </div>
                    </div>

                    <div class="form-group m-form__group row">
                        <div class="col-lg-6">
                            <label class="control-label">Server Address</label><br />
                            <div class="input-group">

                                <input class="form-control m-input" id="FWser" name="FWser">
                            </div>

                        </div>
                        <div class="col-lg-6">
                            <label>Firmware File</label><br />
                            <div class="input-group">

                                <div class="custom-file">

                                    <input type="file" class="custom-file-input" id="file" name="file"
                                           aria-describedby="inputGroupFileAddon01">
                                    <label class="custom-file-label" for="file">Choose firmware</label>
                                </div>
                            </div>
                        </div>
                    </div>


                    <div class="form-group m-form__group row">
                        <div class="col-lg-6">
                            <button type="button" onclick="PostDataFW()" class="btn btn-success"><i class="la la-save"></i> Submit</button>
                            <button type="reset" href="#firmware" data-toggle="collapse" class="btn btn-secondary collapsible"><i class="la la-refresh "></i> Cancel</button>
                        </div>
                    </div>

                </div>


                <div id="config" class="m-form m-form--fit m-form--label-align-right m-form--group-seperator-dashed collapse">
                    <div class="row">
                        <span class="nav-item">
                            <i href="#config" class="fa fa-2x fa-arrow-circle-left collapsible" data-toggle="collapse" style="margin-left: 22px; margin-top: 21px; margin-bottom: -10px; color:#525151;"></i>

                        </span>
                        <h3 style="margin-left: 11px; margin-top: 20px; margin-bottom: -10px;">Device Configuration</h3>

                    </div>

                    <div class="form-group m-form__group row">

                        <div class="col-lg-6 col-sm-12 col-md-12 col-xs-12">


                            <div class="form-group">
                                <label for="SensorId">Sensor</label>
                                <select name="SensorId" id="SensorIdDropDownList" class="form-control"></select>
                            </div>



                        </div>

                        <div class="col-lg-6 col-sm-12 col-md-12 col-xs-12">
                            <div class="form-group">
                                <label for="GraphId">Graph</label>
                                <select name="GraphId" id="GraphIdDropDownlist" class="form-control"></select>
                            </div>

                        </div>

                    </div>

                    <div class="m-form__actions m-form__actions--solid">
                        <div class="row">
                            <div class="col-lg-6">
                                <button type="button" id="submit_DeviceSensorTemplate" class="btn btn-success"><i class="la la-save"></i> Submit</button>
                                <button type="reset" href="#workflow" data-toggle="collapse" class="btn btn-secondary collapsible"><i class="la la-refresh "></i> Cancel</button>

                            </div>
                            <div class="col-lg-6 m--align-right">

                            </div>
                        </div>
                    </div>

                </div>



                <!-- Temprature Line Chart -->
                <div class="m-portlet m-portlet--mobile  m-portlet--rounded" id="HideAndShowLineChart">
                    <div class="m-portlet__body">
                        <div class="m-portlet__head-title">
                            <h3 class="m-portlet__head-text">
                                Device Temprature &nbsp;&nbsp;&nbsp;
                            </h3>
                        </div>
                        <div class="row ">

                            <div class="col-9">
                                <p class="text-center">
                                </p>
                                <div id="chartContainer" style="height: 120px;"></div>
                            </div>
                            <div class="col-3">
                                <span id="temperatureValue" style="margin-top: 30%; margin-left: -60%; font-size:65px"></span>
                            </div>



                        </div>
                    </div>
                </div>

                <!-- Medical -->

                <div class="row" id="HideAndShowLightOnOff">
                    <div class="col-xl-12">
                        <div class="m-portlet m-portlet--mobile  m-portlet--rounded">
                            <div class="m-portlet__body">
                                <div class="row">
                                    <div class="col-6">
                                        <div class="m-portlet__head-title">
                                            <h3 class="m-portlet__head-text">
                                                Device Light On/Off &nbsp;&nbsp;&nbsp;
                                            </h3>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <div class="col-xs-12" style="float:right">
                                            <div class="btn-group" id="toggle_event_editing">
                                                <button type="button" class="btn btn-info locked_active">OFF</button>
                                                <button type="button" class="btn btn-default unlocked_inactive">ON</button>
                                            </div>
                                            <hr />
                                        </div>
                                    </div>
                                </div>


                                <div class="row">
                                    <div class="col-md-6 col-xs-6 col-sm-6 col-lg-6" id="HideAndShowLightOnOff1">
                                        <i class="la la-lightbulb-o text-center" id="BulbOnOffId" style="font-size: 200px;width:200px;color: hsla(50, 0%, 50%, 1);display:block;"></i>
                                    </div>
                                    <div class="col-xs-6">
                                        <i class="fa fa-lightbulb-o text-center" id="BulbOnOffId" style="font-size: 400px;color: hsla(50, 0%, 50%, 1);display:block;"></i>
                                    </div>
                                  
                                </div>
                                <div class="col-xs-12" id="sliderHideAndShowOnLight">
                                    <hr />
                                    <div class="col-xs-2"></div>
                                    <div class="col-xs-8">
                                        <div class="slidecontainer">
                                            <input type="range" min="1" max="100" value="100" class="slider" id="myRange">
                                            <p>Value: <span id="myRangeValue"></span></p>
                                        </div>

                                    </div>
                                    <div class="col-xs-2"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!--End::Section-->
                <!--Begin::Section-->

                <div class="row" id="HideAndShowMap">

                    <div class="col-xl-12">
                        <div class="m-portlet m-portlet--mobile  m-portlet--rounded">

                            <div class="m-portlet__body">
                                <div class="m-portlet__head-title">
                                    <h3 class="m-portlet__head-text">
                                        MAP &nbsp;&nbsp;&nbsp;
                                    </h3>
                                </div>
                                <div class="col-md-12">
                                    <p class="text-center">
                                    </p>
                                    <style>
                                        #routing-map {
                                            width: 100%;
                                            height: 200px;
                                        }
                                    </style>
                                    <div id="routing-response" style="float: right; padding-left: 20px;">

                                    </div>
                                    <div id="routing-error" style="float: right; padding-left: 20px;">
                                    </div>

                                    <div id="routing-map"></div>
                                </div>
                            </div>
                        </div>

                    </div>

                </div>

                <!--End::Section-->
                <!--Device Medical-->
                <div class="row" id="HideAndShowMedical">
                    <div class="col-6">
                        <div class="m-portlet m-portlet--mobile  m-portlet--rounded">
                            <div class="m-portlet__body">
                                <div class="m-portlet__head-title">
                                    <h3 class="m-portlet__head-text">
                                        Heart Beat
                                    </h3>
                                </div>
                                <span id="counterb" class="row"></span>
                                <div class="row">

                                    <div style="float:right;width:auto;">
                                        <div class='container'>
                                            <div class='card temp'>
                                                <div class='inner'>
                                                    <img src="~/Content/Images/img_491812.png" class="icons" />
                                                    <div class='title'>
                                                        <div class='text'>Heart Beat</div>
                                                    </div>
                                                    <span class='number' id="heartbeatvalue"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="col-6">
                        <div class="m-portlet m-portlet--mobile  m-portlet--rounded">

                            <div class="m-portlet__body">

                                <div class="m-portlet__head-title">
                                    <h3 class="m-portlet__head-text">
                                        Fever
                                    </h3>
                                </div>
                                <span id="counter" class="row"></span>
                                <div class="row">
                                    <div style="float:left;width:auto; margin-top: 50px;">
                                        <div id="wrapper">
                                            <div id="termometer">
                                                <div id="temperature" style="height: 90%"></div>
                                                <div id="graduations"></div>
                                            </div>

                                        </div>
                                    </div>
                                    <div style="float:right;width:45%;">
                                        <div class='container'>
                                            <div class='card temp'>
                                                <div class='inner'>
                                                    <div class='icon'></div>
                                                    <div class='title'>
                                                        <div class='text'>TEMPERATURE</div>
                                                    </div>
                                                    <span class='number' id="feverValue"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>


                        </div>
                    </div>
                </div>



                <div class="m-portlet m-portlet--mobile  m-portlet--rounded">

                    <div class="m-portlet__body">
                        <div class="m-portlet__head-title">
                            <h3 class="m-portlet__head-text">
                                Summary &nbsp;&nbsp;&nbsp;
                            </h3>
                        </div>
                        <br />
                        <div class="row">
                            <div class="Dinfo-box">
                                <span class="Dinfo-box-icon bg-aqua"><img src="/Content/Images/devices_image.png" style="height:90%" /></span>
                                <div class="Dinfo-box-content">

                                    <br />
                                    <div class="">
                                        <div class="row">
                                            <div class="col-6" style="text-align:center">
                                                <span>Mac</span>
                                            </div>
                                            <div class="col-6" style="text-align:center">
                                                <span>EMEI</span>

                                            </div>
                                        </div>
                                        <br />
                                        <div class="row" style="margin-top:-5px">
                                            <div class="col-6" style="text-align:center">
                                                <span id="MacVal"></span>

                                            </div>
                                            <div class="col-6" style="text-align:center">
                                                <span id="EmeiVal"></span>

                                            </div>
                                        </div>

                                        @*info *@
                                    </div>
                                    <br />

                                    <br />

                                    <div class="">
                                        <div class="row">
                                            <div class="col-6" style="text-align:center">
                                                <span>Latitude</span>
                                            </div>
                                            <div class="col-6" style="text-align:center">
                                                <span>Logitude</span>

                                            </div>
                                        </div>
                                        <br />
                                        <div class="row" style="margin-top:-5px">
                                            <div class="col-6" style="text-align:center">
                                                <span id="LatVal"></span>

                                            </div>
                                            <div class="col-6" style="text-align:center">
                                                <span id="LongVal"></span>

                                            </div>
                                        </div>

                                        @*info *@
                                    </div>
                                    <input type="hidden" id="Did" />
                                    <input type="hidden" id="macaddress" />

                                   
                                </div><!-- /.info-box-content -->
                            </div><!-- /.info-box -->

                        </div>
                    </div>
                </div>


            </div>
        </div>
        <!-- End:Map Right Slider Modal -->
    </div>
</div>


<!-- Account Right Side Bar -->
<!-- Start:Map Right Slider Modal -->
<div class="modal fade modal-MapRightSlider-fade" id="accountDetailRightSliderModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel2" aria-hidden="true">
    <div class="modal-dialog modal-MapRightSlider-dialog modal-MapRightSlider-slideout" role="document">
        <div class="modal-content modal-content-MapRightSlider">
            <div class="modal-header modal-header-MapRightSlider">

                <h5 class=" modal-header-title" id="accountPanelTitle" style="font-size:30px;padding-top:5px;"></h5>

                <button type="button" class="close modalMapRightSliderClose" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>


            </div>
            <div class="modal-body modal-body-MapRightSlider">


                <!-- Temprature Line Chart -->
                <div class="">


                    <div class="">
                        <div class="m-portlet m-portlet--tab" style="background-color:#F7FCFF">
                            <div class="m-portlet__head">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h3 class="m-portlet__head-text">
                                            Costs
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div id="costchart" style="height: 200px; width: 100%;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="">
                        <div class="m-portlet m-portlet--tab" style="background-color:#F7FCFF">
                            <div class="m-portlet__head">
                                <div class="m-portlet__head-caption">
                                    <div class="m-portlet__head-title">
                                        <span class="m-portlet__head-icon m--hide">
                                            <i class="la la-gear"></i>
                                        </span>
                                        <h3 class="m-portlet__head-text">
                                            Sales
                                        </h3>
                                    </div>
                                </div>
                            </div>
                            <div class="m-portlet__body">
                                <div id="salesChartAcc" style="height: 200px; width: 100%;"></div>
                            </div>
                        </div>

                    </div>




                </div>
                <div class="row">

                    <div class="col-6">
                        <div class="">
                            <div class="m-portlet m-portlet--tab" style="background-color:#F7FCFF">
                                <div class="m-portlet__head">
                                    <div class="m-portlet__head-caption">
                                        <div class="m-portlet__head-title">
                                            <span class="m-portlet__head-icon m--hide">
                                                <i class="la la-gear"></i>
                                            </span>
                                            <h3 class="m-portlet__head-text">
                                                Customer Assets
                                            </h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="m-portlet__body">
                                    <div class="counter">
                                        <i class="la la-money fa-2x"></i>
                                        <h2 id="assetsCountData" class="timer count-title count-number" data-to="" data-speed="1500"></h2>
                                        <p class="count-text ">Customer Assets</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="">
                            <div class="m-portlet m-portlet--tab" style="background-color:#F7FCFF">
                                <div class="m-portlet__head">
                                    <div class="m-portlet__head-caption">
                                        <div class="m-portlet__head-title">
                                            <span class="m-portlet__head-icon m--hide">
                                                <i class="la la-gear"></i>
                                            </span>
                                            <h3 class="m-portlet__head-text">
                                                Workflow Reports
                                            </h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="m-portlet__body">
                                    <div class="counter">
                                        <i class="la la-bar-chart fa-2x"></i>
                                        <h2 id="workflowCountData" class="timer count-title count-number" data-to="" data-speed="1500"></h2>
                                        <p class="count-text ">Workflow Reports</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-6">
                        <div class="">
                            <div class="m-portlet m-portlet--tab" style="background-color:#F7FCFF">
                                <div class="m-portlet__head">
                                    <div class="m-portlet__head-caption">
                                        <div class="m-portlet__head-title">
                                            <span class="m-portlet__head-icon m--hide">
                                                <i class="la la-gear"></i>
                                            </span>
                                            <h3 class="m-portlet__head-text">
                                                Devices
                                            </h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="m-portlet__body">
                                    <div class="counter">
                                        <i class="fa fa-microchip fa-2x"></i>
                                        <h2 id="devicesCountData" class="timer count-title count-number" data-to="" data-speed="1500"></h2>
                                        <p class="count-text ">Devices</p>
                                    </div>
                                </div>
                            </div>

                        </div>



                        <div class="">
                            <div class="m-portlet m-portlet--tab" style="background-color:#F7FCFF">
                                <div class="m-portlet__head">
                                    <div class="m-portlet__head-caption">
                                        <div class="m-portlet__head-title">
                                            <span class="m-portlet__head-icon m--hide">
                                                <i class="la la-gear"></i>
                                            </span>
                                            <h3 class="m-portlet__head-text">
                                                Work Orders
                                            </h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="m-portlet__body">
                                    <div class="counter">
                                        <i class="fa fa-tasks fa-2x"></i>
                                        <h2 id="workorderCountData" class="timer count-title count-number" data-to="" data-speed="1500"></h2>
                                        <p class="count-text ">Work Orders</p>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>




                </div>

                <div class="m-portlet m-portlet--mobile  m-portlet--rounded">
                    <div href="#demo" class="m-portlet__head collapsible" data-toggle="collapse">
                        <div class="m-portlet__head-caption">
                            <div class="m-portlet__head-title">
                                <span class="m-portlet__head-icon"><i class="fa fa-info-circle"></i></span>

                                <h3 href="#demo" class="m-portlet__head-text">
                                    Account Details
                                </h3>
                            </div>
                        </div>
                        <div class="m-portlet__head-tools">
                            <ul class="m-portlet__nav">
                                <li class="m-portlet__nav-item">

                                    <i class="la la-angle-down"></i>

                                </li>
                            </ul>
                        </div>

                    </div>
                    <div id="demo" class="m-portlet__body collapse">
                        <div class="row">
                            <div class="col-6">

                                <span class="mb-0"><span class="fa fa-info-circle" style='margin-right:.50em; display:inline-block;color:#7FCEFF;'>&nbsp;</span><span id="accName"></span></span> <br />
                                <span class="mb-0"><span class="fa fa-briefcase" style='margin-right:.50em; display:inline-block;color:#7FCEFF;'>&nbsp;</span><span id="accType"></span></span><br />
                                <span class="mb-0"><span class="fa fa-users" style='margin-right:.50em; display:inline-block;color:#7FCEFF;'>&nbsp;</span><span id="accSize"></span></span><br />
                                <span class="mb-0"><span class="fa fa-circle" style='margin-right:.50em; display:inline-block;color:#7FCEFF;'>&nbsp;</span> <span id="accStatus"></span></span><br />
                            </div>
                            <div class="col-6">
                                <span class="mb-0"><span class="fa fa-envelope" style='margin-right:.50em; display:inline-block;color:#7FCEFF;'>&nbsp;</span><span id="accEmail"></span></span><br />
                                <span class="mb-0"><span class="fa fa-globe" style='margin-right:.50em; display:inline-block;color:#7FCEFF;'>&nbsp;</span> <span id="accWeb"></span></span><br />
                                <span class="mb-0"><span class="fa fa-location-arrow" style='margin-right:.50em; display:inline-block;color:#7FCEFF;'>&nbsp;</span><span id="accAdd"></span></span><br />
                                <span class="mb-0"><span class="fa fa-industry" style='margin-right:.50em; display:inline-block;color:#7FCEFF;'>&nbsp;</span> <span id="accInd"></span></span><br />
                            </div>

                        </div>
                    </div>



                </div>



            </div>
        </div>
        <!-- End:Map Right Slider Modal -->
    </div>
</div>

@section scripts{

    <script src="~/Content/Metronic/vendors/canvasjs/canvasjs.min.js"></script>
    <script src="~/Content/Metronic/vendors/jvector/jquery.jvectormap.min.js"></script>
    <script src="~/Content/Metronic/vendors/jvector/tests/assets/jquery-jvectormap-world-mill-en.js"></script>

    <script>
        $(document).ready(function () {


            var adminRole = '@(Roles.IsUserInRole("Administrator") ? "true" : "false")';
            var salesRole = '@(Roles.IsUserInRole("Manager") ? "true" : "false")';
            var techRole = '@(Roles.IsUserInRole("User") ? "true" : "false")';

            //Dashoard division based on role
            $('#defaultDashboard').hide();
            $('#salesDashboard').hide();
            $('#techDashboard').hide();

            if (adminRole == "true") {
                $('#defaultDashboard').show();
            }
            else if (salesRole == "true") {
                $('#salesDashboard').show();
            }
            else if (techRole == "true") {
                $('#techDashboard').show();
            }
           //Dashoard division based on role

            function toggleDataSeries(e) {
                if (typeof (e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
                    e.dataSeries.visible = false;
                } else {
                    e.dataSeries.visible = true;
                }

            }

            //Sales chart shared ajax
            var open;
            var closed;
            var won;
            if (adminRole == "true" ||  salesRole == "true") {

                $.ajax({
                type: "GET",
                url: "/Opportunities/GetOppCounts",
                dataType: "json",
                async: false,
                success: function (response) {
                    
                    open = response.Open;
                    closed = response.Lost;
                    won = response.Lostwon;
                   

                },
                failure: function () {
                    alert("Failed!");
                }
                });


                var chart = new CanvasJS.Chart("salesChart", {
                    //exportEnabled: true,
                    animationEnabled: true,
                    backgroundColor: "transparent",
                    title: {
                        //text: "Sales Chart"
                    },
                    legend: {
                        cursor: "pointer",
                        verticalAlign: "bottom",
                        horizontalAlign: "center",
                        itemclick: explodePie
                    },
                    data: [{
                        type: "pie",
                        showInLegend: true,
                        toolTipContent: "{name}: <strong>{y}%</strong>",
                        indexLabel: "{name} - {y}%",
                        dataPoints: [
                            { y: open, name: "Open", exploded: true },
                            { y: closed, name: "Closed as Lost" },
                            { y: won, name: "Closed as Won" }
                        ]
                    }]
                });
                chart.render();


                var chart2 = new CanvasJS.Chart("salesChart2", {
                    //exportEnabled: true,
                    animationEnabled: true,
                    backgroundColor: "transparent",
                    title: {
                        //text: "Sales Chart"
                    },
                    legend: {
                        cursor: "pointer",
                        verticalAlign: "center",
                        horizontalAlign: "right",
                        itemclick: explodePie
                    },
                    data: [{
                        type: "pie",
                        showInLegend: true,
                        toolTipContent: "{name}: <strong>{y}%</strong>",
                        indexLabel: "{name} - {y}%",
                        dataPoints: [
                            { y: open, name: "Open", exploded: true },
                            { y: closed, name: "Closed as Lost" },
                            { y: won, name: "Closed as Won" }
                        ]
                    }]
                });
                chart2.render();

            }
             //Sales chart shared ajax

            if (adminRole == "true") {

                @* Tech Counts *@
                $.ajax({
                    type: "GET",
                    url: "/Dashboard/GetTechCount",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                        
                        document.getElementById("workordercounts").textContent = response.Workorders;
                        document.getElementById("alertcounts").textContent = response.Alerts;
                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });

                //Cost Charts
                var CostsDataPoints = [];
                $.ajax({
                    type: "GET",
                    url: "/Devices/GetAllCosts",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                        for (var i = 0; i < response.length; i++) {
                            var obj = { label: resolvedate(response[i].date), y: response[i].Value, color: "orange" }
                            CostsDataPoints.push(obj);
                        }
                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });

                var Costschart = new CanvasJS.Chart("CostsChart", {
                    theme: "light2",
                    animationEnabled: true,
                    backgroundColor: "transparent",
                    title: {
                        // text: "Game of Thrones Viewers of the First Airing on HBO"
                    },
                    axisY: {
                        includeZero: false,
                        title: "Cost",
                        suffix: "$"
                    },
                    toolTip: {
                        shared: "true"
                    },
                    legend: {
                        cursor: "pointer",
                        itemclick: toggleDataSeries
                    },
                    data: [
                        {
                            type: "spline",
                            lineColor: "orange",
                            showInLegend: true,
                            legendMarkerColor: "orange",
                            yValueFormatString: "##.00$",
                            name: "Consumptions",
                            dataPoints: CostsDataPoints
                        }
                    ]
                });
                Costschart.render();

                //Device Map configuration
                var devicemarkers = [];

                var deviceMapObj = new jvm.Map({
                    container: $('#DevicesMap'),
                    map: 'world_mill_en',
                    backgroundColor: "transparent",
                    regionStyle: {
                        initial: {
                            fill: '#7fceff',
                            "fill-opacity": 1,
                            stroke: 'none',
                            "stroke-width": 0,
                            "stroke-opacity": 1
                        },
                        hover: {
                            "fill-opacity": 0.8,
                            cursor: 'pointer'
                        },
                        selected: {
                            fill: 'yellow'
                        },
                        selectedHover: {
                        }
                    },
                    markers: devicemarkers,
                    onMarkerClick: function (event, index) {
                        MapRightSlider(devicemarkers[index].EMEI, devicemarkers[index].lat,
                            devicemarkers[index].long, devicemarkers[index].mac, devicemarkers[index].name, devicemarkers[index].cloud, devicemarkers[index].data, devicemarkers[index].id);
                    }


                });

                //fetch device markers for all devices

                $.ajax({
                    type: "GET",
                    url: "/Devices/GetAlldevicesLongLat",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                        for (var i = 0; i < response.length; i++) {
                            var obj = {
                                latLng: [response[i].Latitude, response[i].Longitude], name: response[i].Name,
                                mac: response[i].Mac, EMEI: response[i].EMEI, lat: response[i].Latitude, long: response[i].Longitude,
                                cloud: response[i].CloudServices, data: response[i].CloudData, id: response[i].deviceID, style: { r: 5 }
                            }
                            devicemarkers.push(obj);
                        }
                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });

                deviceMapObj.addMarkers(devicemarkers, []);

                //fetch device markers for all devices


                //Fetch devices by account
                $('#accountmap').on('change', function () {

                    var accountId = $('#accountmap option:selected').val();
                    if (accountId !== "Select") {
                        devicemarkers = [];
                        $.ajax({
                            type: "GET",
                            data: { accountId: accountId },
                            url: "/Devices/GetsingledevicesLongLat",
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                            async: false,
                            success: function (response) {
                                for (var i = 0; i < response.length; i++) {
                                    var obj = { latLng: [response[i].Latitude, response[i].Longitude], name: response[i].Name, style: { r: 5 } }
                                    devicemarkers.push(obj);
                                }
                            },
                            failure: function () {
                                alert("Failed!");
                            }
                        });
                        deviceMapObj.addMarkers(devicemarkers, []);
                    }

                });
                //Fetch devices by account

                //populating list of accounts in device map drop down
                $.ajax({
                    type: "GET",
                    url: "/Master/GetAccounts",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                        $('#accountmap').html('');
                        var options = '';
                        options += '<option value="Select">Select by account</option>';
                        for (var i = 0; i < response.length; i++) {
                            options += '<option value="' + response[i].Value + '">' + response[i].Text + '</option>';
                        }
                        $('#accountmap').append(options);

                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });
                //End populating list of accounts

            }


            if (salesRole == "true")
            {
                //fetch Opportunity markers for all devices
                var oppmarkers = [];

                var OpportunitiesMapObj = new jvm.Map({
                    container: $('#OpportunitiesMap'),
                    map: 'world_mill_en',
                    backgroundColor: "transparent",
                    regionStyle: {
                        initial: {
                            fill: '#7fceff',
                            "fill-opacity": 1,
                            stroke: 'none',
                            "stroke-width": 0,
                            "stroke-opacity": 1
                        },
                        hover: {
                            "fill-opacity": 0.8,
                            cursor: 'pointer'
                        },
                        selected: {
                            fill: 'yellow'
                        },
                        selectedHover: {
                        }
                    },
                    markers: oppmarkers,
                    onMarkerClick: function (event, index) {
                       
                        LoadOpportunityOnId(oppmarkers[index].id);
                    }
                });

                $.ajax({
                    type: "GET",
                    url: "/Opportunities/GetAllOpportunitiesLongLat",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                        for (var i = 0; i < response.length; i++) {
                            var obj = { latLng: [response[i].Latitude, response[i].Longitude], name: response[i].Name, id: response[i].OpportunityId, style: { r: 5 } }
                            oppmarkers.push(obj);
                        }
                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });

                OpportunitiesMapObj.addMarkers(oppmarkers, []);
                //fetch Opportunity markers for all devices


                //fetch Accounts markers for all devices

                var accountmarkers = [];
                $.ajax({
                    type: "GET",
                    url: "/Accounts/GetAllAccountsLongLat",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                        for (var i = 0; i < response.length; i++) {
                            var obj = { latLng: [response[i].Latitude, response[i].Longitude], name: response[i].Name, id: response[i].AccountId, style: { r: 5 } }
                            accountmarkers.push(obj);
                        }
                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });
                var AccountsMapObj = new jvm.Map({
                    container: $('#AccountsMap'),
                    map: 'world_mill_en',
                    backgroundColor: "transparent",
                    regionStyle: {
                        initial: {
                            fill: '#7fceff',
                            "fill-opacity": 1,
                            stroke: 'none',
                            "stroke-width": 0,
                            "stroke-opacity": 1
                        },
                        hover: {
                            "fill-opacity": 0.8,
                            cursor: 'pointer'
                        },
                        selected: {
                            fill: 'yellow'
                        },
                        selectedHover: {
                        }
                    },
                    markers: accountmarkers,
                    onMarkerClick: function (event, index) {
                        
                        accSidebar(accountmarkers[index].id, accountmarkers[index].name);

                    }
                });




                AccountsMapObj.addMarkers(accountmarkers, []);

                //fetch Account markers for all devices

                var boiler, engine, gen, proj, tours;
                $.ajax({
                    type: "GET",
                    url: "/CustomerAssets/GetAssetTypes",
                    dataType: "json",
                    async: false,
                    success: function (response) {

                        boiler = response.Boiler;
                        engine = response.Engine;
                        gen = response.Generator;
                        proj = response.Projector;
                        tours = response.Tours;
                        
                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });

                var Assetschart = new CanvasJS.Chart("Assetschart", {
                    //exportEnabled: true,
                    animationEnabled: true,
                    backgroundColor: "transparent",
                    title: {
                        //text: "Sales Chart"
                    },
                    legend: {
                        cursor: "pointer",
                        verticalAlign: "center",
                        horizontalAlign: "right",
                        itemclick: explodePie
                    },
                    data: [{
                        type: "pie",
                        showInLegend: true,
                        toolTipContent: "{name}: <strong>{y}%</strong>",
                        indexLabel: "{name} - {y}%",
                        dataPoints: [
                            { y: boiler, name: "boiler", color: "green" },
                            { y: engine, name: "Engin" },
                            { y: gen, name: "Generator", color: "yellow" },
                            { y: proj, name: "Projector", color: "blue" },
                            { y: tours, name: "Tours", color: "purple" }
                        ]
                    }]
                });
                Assetschart.render();
                //Assets chart End

            }


            if (techRole == "true")
            {

                @* Disconnectionchart *@
            var disconnectiondatapoints = [];
                $.ajax({
                    type: "GET",
                    url: "/Devices/GetAllDisconnectionList",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                       
                        for (var i = 0; i < response.length; i++) {
                            var obj = { label: resolvedate(response[i].date), y: response[i].Value, color: "orange" }

                            disconnectiondatapoints.push(obj);
                        }
                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });

                var Disconnectionchart = new CanvasJS.Chart("Disconnectionchart", {
                    height: 270,
                    theme: "light2",
                    backgroundColor: "transparent",
                    animationEnabled: true,
                    title: {
                    },
                    axisY: {
                        includeZero: false,
                        title: "Disconnections",
                        suffix: "--"
                    },
                    toolTip: {
                        shared: "true"
                    },
                    legend: {
                        cursor: "pointer",
                        itemclick: toggleDataSeries
                    },
                    data: [
                        {
                            type: "spline",
                            lineColor: "orange",
                            showInLegend: true,
                            legendMarkerColor: "orange",
                            yValueFormatString: "##",
                            name: "Disconnectivity",
                            dataPoints: disconnectiondatapoints
                        }
                    ]
                });
                Disconnectionchart.render();


                //Power consumption

                var consumptiondatapoints = [];
                $.ajax({
                    type: "GET",
                    url: "/Devices/GetAllConsumption",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                        for (var i = 0; i < response.length; i++) {
                            var obj = { label: resolvedate(response[i].date), y: response[i].Value, color: "orange" }
                            consumptiondatapoints.push(obj);
                        }
                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });

                var Powerconsumptionchart = new CanvasJS.Chart("powerconsumptionchart", {
                    height: 270,
                    theme: "light2",
                    backgroundColor: "transparent",
                    animationEnabled: true,
                    title: {
                        // text: ""
                    },
                    axisY: {
                        includeZero: false,
                        title: "Power Consumption",
                        suffix: "--"
                    },
                    toolTip: {
                        shared: "true"
                    },
                    legend: {
                        cursor: "pointer",
                        itemclick: toggleDataSeries
                    },
                    data: [
                        {
                            type: "spline",
                            lineColor: "red",
                            showInLegend: true,
                            legendMarkerColor: "red",
                            yValueFormatString: "##.00$",
                            name: "Power Consumption",
                            dataPoints: consumptiondatapoints
                        }
                    ]
                });
                Powerconsumptionchart.render();


                var Total, Updated, Pending;
                $.ajax({
                    type: "GET",
                    url: "/Firmwares/GetFirmwares",
                    dataType: "json",
                    async: false,
                    success: function (response) {

                        Total = response.Total;
                        Pending = response.Pending;
                        Updated = response.Total - response.Pending;
                        

                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });
                var firmwareDatapointsU = [];
                var firmwareDatapointsP = [];
                $.ajax({
                    type: "GET",
                    url: "/Firmwares/GetFirmwaresPending",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                        for (var i = 0; i < response.length; i++) {
                            var obj = { label: resolvedate(response[i].date), y: response[i].Value }
                            firmwareDatapointsP.push(obj);
                        }
                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });
                $.ajax({
                    type: "GET",
                    url: "/Firmwares/GetFirmwaresUpdated",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                        for (var i = 0; i < response.length; i++) {
                            var obj = { label: resolvedate(response[i].date), y: response[i].Value }
                            firmwareDatapointsU.push(obj);
                        }
                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });
                

                var firmwareChart = new CanvasJS.Chart("gatewayChart", {
                    animationEnabled: true,
                    backgroundColor: "transparent",
                    title: {

                    },
                    axisX: {

                    },
                    axisY: {
                        valueFormatString: "",
                        gridColor: "#B6B1A8",
                        tickColor: "#B6B1A8"
                    },
                    toolTip: {
                        shared: true,
                        content: toolTipContent
                    },
                    data: [{
                        type: "stackedColumn",
                        showInLegend: true,
                        color: "#696661",
                        name: "Pending",
                        dataPoints: firmwareDatapointsU
                    },
                    {
                        type: "stackedColumn",
                        showInLegend: true,
                        name: "Updated",
                        color: "#EDCA93",
                        dataPoints: firmwareDatapointsP
                    }
                    ]
                });
                firmwareChart.render();

                function toolTipContent(e) {
                    var str = "";
                    var total = 0;
                    var str2, str3;
                    for (var i = 0; i < e.entries.length; i++) {
                        var str1 = "<span style= \"color:" + e.entries[i].dataSeries.color + "\"> " + e.entries[i].dataSeries.name + "</span>: $<strong>" + e.entries[i].dataPoint.y + "</strong>bn<br/>";
                        total = e.entries[i].dataPoint.y + total;
                        str = str.concat(str1);
                    }
                    str2 = "<span style = \"color:DodgerBlue;\"><strong>" + (e.entries[0].dataPoint.x).getFullYear() + "</strong></span><br/>";
                    total = Math.round(total * 100) / 100;
                    str3 = "<span style = \"color:Tomato\">Total:</span><strong> $" + total + "</strong>bn<br/>";
                    return (str2.concat(str)).concat(str3);
                }


                var mqtt, http, lorawan, cellular, ethernet, wifi;

                $.ajax({
                    type: "GET",
                    url: "/Devices/GetCounts",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                        mqtt = response.MQTT;
                        http = response.HTTP;
                        lorawan = response.LORAWAN;
                        cellular = response.CELLULAR;
                        ethernet = response.ETHERNET;
                        wifi = response.WIFI;
                        

                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });

                $.ajax({
                    type: "GET",
                    url: "/WorkOrders/GetWorkorderCount",
                    dataType: "json",
                    async: false,
                    success: function (response) {
                      

                    },
                    failure: function () {
                        alert("Failed!");
                    }
                });


                var channelschart = new CanvasJS.Chart("channelschart", {
                    animationEnabled: true,
                    theme: "light2", // "light1", "light2", "dark1", "dark2"
                    backgroundColor: "transparent",
                    title: {
                        //text: "Top Oil Reserves"
                    },
                    axisY: {
                        title: "Channels"
                    },
                    data: [{
                        type: "column",
                        showInLegend: true,
                        legendMarkerColor: "grey",
                        legendText: "channels",
                        dataPoints: [
                            { y: wifi, label: "Wi-Fi" },
                            { y: cellular, label: "Cellular" },
                            { y: http, label: "HTTP" },
                            { y: mqtt, label: "MQTT" },
                            { y: ethernet, label: "Ethernet" },
                            { y: lorawan, label: "LoraWAN" },
                        ]
                    }]
                });
                channelschart.render();

            }

            function explodePie(e) {
                if (typeof (e.dataSeries.dataPoints[e.dataPointIndex].exploded) === "undefined" || !e.dataSeries.dataPoints[e.dataPointIndex].exploded) {
                    e.dataSeries.dataPoints[e.dataPointIndex].exploded = true;
                } else {
                    e.dataSeries.dataPoints[e.dataPointIndex].exploded = false;
                }
                e.chart.render();
            }
        /*Maps End*/

        });


        function resolvedate(DateValue)
        {
            var DateVal = new Date(parseInt(DateValue.substr(6)));
            var dd = DateVal.getDate();

            var mm = DateVal.getMonth();
            var yyyy = DateVal.getFullYear();
            if (dd < 10) {
                dd = '0' + dd;
            }

            if (mm < 10) {
                mm = '0' + mm;
            }

            date = mm + '/' + dd + '/' + yyyy;
            return date;
        }


        $(function () {

            $('#jstree1').on('changed.jstree', function (e, data) {
                var objNode = data.instance.get_node(data.selected);

                if (objNode == false) { return false; }


            }).jstree({
                "core": {
                    "multiple": true,
                    "check_callback": true,
                    'themes': {
                        "responsive": true,
                        'variant': 'larg',
                        'stripes': false,
                        'dots': false,
                        'icons': false
                    }
                },
                "types": {
                    "default": {
                        
                    },
                    "file": {
                        "icon": "fa fa-microchip icon-state-warning icon-lg"

                    }
                },
                "plugins": ["dnd", "state", "types", "sort"]
            });

            $('#consumptionTree').on('changed.jstree', function (e, data) {
                var objNode = data.instance.get_node(data.selected);


                if (objNode == false) { return false; }


            }).jstree({
                "core": {
                    "multiple": true,
                    "check_callback": true,
                    'themes': {
                        "responsive": true,
                        'variant': 'larg',
                        'stripes': false,
                        'dots': false,
                        'icons': false
                    }
                },
                "types": {
                    "default": {

                    },
                    "file": {
                        "icon": "fa fa-microchip icon-state-warning icon-lg"

                    }
                },
                "plugins": ["dnd", "state", "types", "sort"]
            });

        });
    </script>

    @*devicerightside*@
    <script>
        var MapRightSlider = function (EMEI, lat, long, mac, name, cloud, data, id) {

            $('#MapRightSliderModal').modal('show');
            $('#btnsCloud').hide();
            $('#btnsAmazon').hide();
            $('#btnsINCA').hide();
            $('#EmeiVal').html(EMEI);
            $('#LatVal').html(lat);
            $('#LongVal').html(long);
            $('#MacVal').html(mac);
            $('#Dname').html(name);
            $('#Did').html(id);
            document.getElementById('macaddress').value = mac;
            
            if (cloud == "IBM") {
                $('#btnsCloud').show();
                $('#btnsINCA').hide();
                $('#btnsAmazon').hide();

            }
            else if (cloud == "Amazon") {
                $('#btnsCloud').hide();
                $('#btnsAmazon').show();
                $('#btnsINCA').hide();
            }
            else {
                $('#btnsCloud').hide();
                $('#btnsINCA').show();
                $('#btnsAmazon').hide();

            }


            //var str = data.split(",");

            ////Organization ID
            //var org = str[0].toString();
            //org = org.match(":(.*)");
            //var orgID = org[1].toString();
            //orgID = orgID.substr(1, orgID.length - 2);
            ////Application Name
            //var app = str[1].toString();
            //app = app.match(":(.*)");
            //app = app[1].toString();
            //var appname = app.substr(1, app.length - 2);
            ////Device Type
            //var dev = str[4].toString();
            //dev = dev.match(":(.*)");
            //dev = dev[1].toString();
            //var deviceType = dev.substr(1, dev.length - 2);

            ////Device ID substr.length-1
            //var devid = str[5].toString();
            //devid = devid.match(":(.*)");
            //devid = devid[1].toString();
            //var deviceID = devid.substr(1, devid.length - 2);

            //url = "https://www." + orgID + "." + appname + ".ibmcloud.com/dashboard/devices/drilldown/" + deviceType + ":" + deviceID;
            GetGraphOfMAC(mac);


        }
        function GetGraphOfMAC(MacAddress) {

           
            $('#HideAndShowLineChart').hide();
            $('#HideAndShowMap').hide();
            $('#HideAndShowLightOnOff').hide();
            $('#HideAndShowLightOnOff1').hide();
            $('#HideAndShowLightOnOff2').hide();
            $('#HideAndShowMedical').hide();
            var obj = { MacAddress: MacAddress };
            $.ajax({
                type: "GET",
                url: "/Devices/GetGraphOfMACData",
                data: obj,
                contentType: "application/json; charset=utf-8",
                dataType: "text",
                success: function (response) {
                    var data = JSON.parse(response);
                    
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].SensorName == "Temperature" && data[i].GraphName == "Line") {
                            $('#HideAndShowLineChart').show();
                        }
                        else if (data[i].SensorName == "Location" && data[i].GraphName == "Map") {
                            $('#HideAndShowMap').show();
                        }
                        else if (data[i].SensorName == "Light" && data[i].GraphName == "On/Off") {
                            $('#HideAndShowLightOnOff').show();
                            $('#HideAndShowLightOnOff1').show();
                            $('#HideAndShowLightOnOff2').show();
                            ResetBlobSliderValue();
                        }
                        else if (data[i].SensorName == "Heat rate / Fever" && data[i].GraphName == "Medical / Checkups") {

                            $('#HideAndShowMedical').show();
                        }
                        for (var i = 0; i < data.length; i++) {
                            $("#Wsensors").append(new Option(data[i].SensorName, data[i].SensorName));
                        }
                    }
                },
                failure: function () {
                    alert("Failed!");
                    $('body').removeClass('m-page--loading');
                }
            });

        }

        var PostDataFW = function () {
            var ver = document.getElementById("FWver").value;
            var des = document.getElementById("FWdes").value;
            var ser = document.getElementById("FWser").value;
            var file = document.getElementById("file").value;
            var devname = document.getElementById("Dname").textContent;
            var obj = { DevName: devname, Version: ver, Desc: des, Serv: ser, File: file };
            $.ajax({
                type: "POST",
                url: "/Firmwares/FWDevice",
                data: obj,
                dataType: "text",
                success: function (response) {
                    if (response == "error") {
                        ("Failed to update on mqtt.");
                    }
                    else {
                        alert("Failed to update on mqtt.");
                    }

                },
                failure: function () {
                    alert("Failed!");
                }
            })
        }

        var PostData = function () {
            var name = document.getElementById("Wname").value;
            var sensors = document.getElementById("Wsensors").value;
            var threshold = document.getElementById("WThreshold").value;
            var threshold1 = document.getElementById("WThreshold1").value;
            var action = document.getElementById("Waction").value;
            var priority = document.getElementById("Wpriority").value;
            var desc = document.getElementById("Wdescription").value;
            var accID = document.getElementById("accID").textContent;
            var devname = document.getElementById("Dname").textContent;
            var macadd = document.getElementById("macaddress").value;
            var cloud = document.getElementById("WCloud").value;
            if (priority == "High") {
                priority = 100;
            }
            else if (priority == "Medium") {
                priority = 66;
            }
            else if (priority == "Low") {
                priority = 33;
            }
            var thres = threshold + "," + threshold1;
            var obj = { Name: name, Sensor: sensors, Thresh: thres, Action: action, Priority: priority, desc: desc, AccountId: accID, DevName: devname, mac: macadd, Cloud: cloud };
            $.ajax({
                type: "POST",
                url: "/WorkFlows/workflowDevice",
                data: obj,
                dataType: "text",
                success: function (response) {
                    if (response == "error") {
                        ("Failed to update on mqtt.");
                    }
                    else {
                        alert("Failed to update on mqtt.");
                    }

                },
                failure: function () {
                    alert("Failed!");
                }
            })
            $('#workflow').hide();
        }

        var dps = []; // dataPoints
        var chart = new CanvasJS.Chart("chartContainer", {
            height: 120,
            width: 280,
            title: {
                text: "Live Temperature"
            },
            axisY: {
                includeZero: false
            },
            data: [{
                type: "line",
                dataPoints: dps
            }]
        });

        var xVal = 0;
        var yVal = 100;
        var updateInterval = 1000;
        var dataLength = 10; // number of dataPoints visible at any point
        var count = 0;
        var updateChart = function (Time, Temperature) {
            dps.push({
                x: Time,
                y: Temperature
            });
            count++;
            if (dps.length > dataLength) {
                dps.shift();
                count = 0;
            }
            //if (count === 5) {
            //}
            document.getElementById("temperatureValue").textContent = Temperature + ascii(176) + "C";

            chart.render();
        };


        $("#deviceTitle").text(localStorage.getItem('selectedDevice'));
        function ascii(a) { return String.fromCharCode(a); }
    </script>

    @*relay and dimmer*@
    <script>
        $(document).ready(function () {
            $('#sliderHideAndShowOnLight').hide();
        });

        $('#toggle_event_editing button').click(function () {

            var IsDeviceOn = false;

            if ($(this).hasClass('locked_active') || $(this).hasClass('unlocked_inactive')) {
                /* code to do when unlocking */
                $('#switch_status').html('Switched on.');
                $('#BulbOnOffId').removeAttr('style');
                $('#BulbOnOffId').attr('style', "font-size: 200px;color: hsla(50, 100%, 50%, 1);display:block;");
                $('#sliderHideAndShowOnLight').show();
                IsDeviceOn = true;
            } else {
                /* code to do when locking */
                $('#switch_status').html('Switched off.');
                $('#BulbOnOffId').removeAttr('style');
                $('#BulbOnOffId').attr('style', "font-size: 200px;color: hsla(50, 0%, 50%, 1);display:block;");
                $('#sliderHideAndShowOnLight').hide();
                IsDeviceOn = false;
            }

            /* reverse locking status */
            $('#toggle_event_editing button').eq(0).toggleClass('locked_inactive locked_active btn-default btn-info');
            $('#toggle_event_editing button').eq(1).toggleClass('unlocked_inactive unlocked_active btn-info btn-default');

            var obj = { deviceStatus: IsDeviceOn };
            $.ajax({
                type: "POST",
                url: "/Devices/SendMessageToMqtt",
                data: obj,
                dataType: "text",
                success: function (response) {
                    if (response == "error") {
                        ("Failed to update on mqtt.");
                    }
                    else {
                        alert("Failed to update on mqtt.");
                    }

                },
                failure: function () {
                    alert("Failed!");
                }
            });

        });


        var slider = document.getElementById("myRange");
        var output = document.getElementById("myRangeValue");
        var slidevalue = slider.value;
        output.innerHTML = slider.value;

        slider.oninput = function () {
            $('#BulbOnOffId').attr('style', "font-size: 200px;color: hsla(50, " + this.value + "%, 50%, 1);display:block;");
            output.innerHTML = this.value;
            slidevalue = this.value;
            var obj = { silderValue: slidevalue };
            $.ajax({
                type: "POST",
                url: "/Devices/SendMessageToMqtts",
                data: obj,
                success: function (response) {
                    if (response == "error") {
                        ("Failed to update on mqtt.");
                    }
                    else {
                        alert("Failed to update on mqtt.");
                    }
                },
                failure: function () {
                    alert("Failed!");
                }
            });
        }

        var ResetBlobSliderValue = function () {
            $('#myRange').val('100');
            $('#myRangeValue').html('100');
        }

    </script>

    @*Configure device*@

    <script>
        $(function () {
            GetGraphDropDownData();
            GetSensorDropDownData();
        });

        function GetGraphDropDownData() {
            $.ajax({
                type: "GET",
                url: "/Devices/GetGraphDropDownList",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    $('#GraphIdDropDownlist').html('');
                    var options = '';
                    options += '<option value="Select">Select</option>';
                    for (var i = 0; i < response.length; i++) {
                        options += '<option value="' + response[i].GraphId + '">' + response[i].GraphName + '</option>';
                    }
                    $('#GraphIdDropDownlist').append(options);
                },
                failure: function () {
                    alert("Failed!");
                }
            });
        }

        function GetSensorDropDownData() {
            $.ajax({
                type: "GET",
                url: "/Devices/GetSensorDropDownList",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    $('#SensorIdDropDownList').html('');
                    var options = '';
                    options += '<option value="Select">Select</option>';
                    for (var i = 0; i < response.length; i++) {
                        options += '<option value="' + response[i].SensorId + '">' + response[i].SensorName + '</option>';
                    }
                    $('#SensorIdDropDownList').append(options);
                },
                failure: function () {
                    alert("Failed!");
                }
            });
        }

        $('#submit_DeviceSensorTemplate').on("click", function () {


            $('#submit_DeviceSensorTemplate').attr('disabled', 'disabled');
            $('#submit_DeviceSensorTemplate').html('Please wait..');

            var DeviceId = document.getElementById("Did").textContent;
            var SensorId = $('#SensorIdDropDownList').val();
            var GraphId = $('#GraphIdDropDownlist').val();

            if (SensorId == "Select" || SensorId == null) {
                alert("Please Select a Device Sensor.");
                $('#submit_DeviceSensorTemplate').removeAttr('disabled');
                $('#submit_DeviceSensorTemplate').html('Submit');
                return false;
            }
            else if (GraphId == null || GraphId == "Select") {
                alert("pleae select a Device Graph.");
                $('#submit_DeviceSensorTemplate').removeAttr('disabled');
                $('#submit_DeviceSensorTemplate').html('Submit');
                return false;
            }

            var obj = { DeviceId: DeviceId, SensorId: SensorId, GraphId: GraphId };
            $.ajax({
                type: "GET",
                url: "/Devices/SubmitDeviceSensorGraph",
                data: obj,
                contentType: "application/json; charset=utf-8",
                dataType: "text",
                success: function (response) {
                    if (response == "error") {
                        toastr.warning("Device Sensor Graph is not Saved. Please Refresh the page.");
                    }
                    else {
                        toastr.success("Device Sensor Graph is saved successfully.");
                        $("#config").hide();

                    }

                },
                failure: function () {
                    alert("Failed!");
                }
            });





        });

        //For tracking map
        jQuery.support.cors = true;

        var host;
        var defaultKey = "f8be18e9-3ab7-4874-9520-b385c841d82f";
        var profile = "car";

        // create a routing client to fetch real routes, elevation.true is only supported for vehicle bike or foot
        var ghRouting = new GraphHopper.Routing({ key: defaultKey, host: host, vehicle: profile, elevation: false });


        var routingMap = createMap('routing-map');
        setupRoutingAPI(routingMap, ghRouting);

        $('#MapRightSliderModal').on('shown.bs.modal', function () {

            setTimeout(function () {
                routingMap.invalidateSize();
            }, 10);
        });



        function resolvedate(DateValue) {
            var DateVal = new Date(parseInt(DateValue.substr(6)));
            var dd = DateVal.getDate();

            var mm = DateVal.getMonth();
            var yyyy = DateVal.getFullYear();
            if (dd < 10) {
                dd = '0' + dd;
            }

            if (mm < 10) {
                mm = '0' + mm;
            }

            date = mm + '/' + dd + '/' + yyyy;
            return date;
        }
        //Map tracking Start PART 2

        var iconObject = L.icon({
            iconUrl: '/Content/Metronic/vendors/graphhopper/img/marker-icon.png',
            shadowSize: [50, 64],
            shadowAnchor: [4, 62],
            iconAnchor: [12, 40]
        });

        function setupRoutingAPI(map, ghRouting) {

            map.setView([52.521235, 13.3992], 12);

            var instructionsDiv = $("#instructions");

            map.on('click', function (e) {
                if (ghRouting.points.length > 1) {
                    ghRouting.clearPoints();
                    routingLayer.clearLayers();
                }
                //Lahore
                e.latlng.lat = 31.520;
                e.latlng.lng = 74.3587;

                L.marker([31.20, 74.3587], { icon: iconObject }).addTo(routingLayer);

                //Karachi
                e.latlng.lat = 24.8607;
                e.latlng.lng = 67.0011;
                L.marker(e.latlng, { icon: iconObject }).addTo(routingLayer);

                // ghRouting.addPoint(new GHInput(e.latlng.lat, e.latlng.lng));
                ghRouting.addPoint(new GHInput(31.5204, 74.3587));
                ghRouting.addPoint(new GHInput(24.8607, 67.0011));

                if (ghRouting.points.length > 1) {
                    // ******************
                    //  Calculate route!
                    // ******************
                    ghRouting.doRequest()
                        .then(function (json) {
                            var path = json.paths[0];
                            routingLayer.addData({
                                "type": "Feature",
                                "geometry": path.points
                            });
                            var outHtml = "Distance in meter:" + path.distance;
                            outHtml += "<br/>Times in seconds:" + path.time / 1000;
                            outHtml += "<br/><a href='" + ghRouting.getGraphHopperMapsLink() + "'>GraphHopper Maps</a>";
                            $("#routing-response").html(outHtml);

                            if (path.bbox) {
                                var minLon = path.bbox[0];
                                var minLat = path.bbox[1];
                                var maxLon = path.bbox[2];
                                var maxLat = path.bbox[3];
                                var tmpB = new L.LatLngBounds(new L.LatLng(minLat, minLon), new L.LatLng(maxLat, maxLon));
                                map.fitBounds(tmpB);
                            }

                            instructionsDiv.empty();
                            if (path.instructions) {
                                var allPoints = path.points.coordinates;
                                var listUL = $("<ol>");
                                instructionsDiv.append(listUL);
                                for (var idx in path.instructions) {
                                    var instr = path.instructions[idx];

                                    // use 'interval' to find the geometry (list of points) until the next instruction
                                    var instruction_points = allPoints.slice(instr.interval[0], instr.interval[1]);

                                    // use 'sign' to display e.g. equally named images

                                    $("<li>" + instr.text + " <small>(" + ghRouting.getTurnText(instr.sign) + ")</small>" +
                                        " for " + instr.distance + "m and " + Math.round(instr.time / 1000) + "sec" +
                                        ", geometry points:" + instruction_points.length + "</li>").appendTo(listUL);
                                }
                            }

                        })
                        .catch(function (err) {
                            var str = "An error occured: " + err.message;
                            $("#routing-response").text(str);
                        });
                }
            });

            //start

            //End

            var instructionsHeader = $("#instructions-header");
            instructionsHeader.click(function () {
                instructionsDiv.toggle();
            });

            var routingLayer = L.geoJson().addTo(map);
            routingLayer.options = {
                style: { color: "#00cc33", "weight": 5, "opacity": 0.6 }
            };
        }



    </script>

}